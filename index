<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Residential Status Calculator - India</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f8f9fa;
        margin: 0;
        padding: 0;
        color: #333;
    }
    header {
        background-color: #003366;
        color: white;
        padding: 20px;
        text-align: center;
    }
    main {
        max-width: 700px;
        margin: 40px auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    label {
        font-weight: bold;
        display: block;
        margin-top: 15px;
    }
    input[type="number"] {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        margin-top: 20px;
        cursor: pointer;
    }
    button:hover {
        background-color: #0056b3;
    }
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 26px;
        margin-top: 5px;
    }
    .switch input {display:none;}
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0; left: 0; right: 0; bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 26px;
    }
    .slider:before {
        position: absolute;
        content: "";
        height: 20px; width: 20px;
        left: 3px; bottom: 3px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: #28a745;
    }
    input:checked + .slider:before {
        transform: translateX(24px);
    }
    #result {
        margin-top: 20px;
        font-size: 1.1em;
        font-weight: bold;
        background-color: #e9f7ef;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #28a745;
    }
</style>
</head>
<body>
<header>
    <h1>Residential Status Identifier</h1>
    <p>Based on Income Tax Act, 1961 (India)</p>
</header>

<main>
    <label>Select type of person:</label>
    <select id="personType">
        <option value="individual">Individual</option>
        <option value="huf">HUF</option>
        <option value="company">Company</option>
        <option value="firm">Firm</option>
    </select>
    <button onclick="start()">Start</button>

    <div id="questionArea"></div>
    <div id="result"></div>
</main>

<script>
let person = "";
let year = 0;
let answers = {};

function start() {
    person = document.getElementById("personType").value;
    answers = {};
    document.getElementById("result").innerHTML = "";
    askYear();
}

function askYear() {
    const q = `
        <label>Enter the year (e.g. 2024 for 2024-25):</label>
        <input type="number" id="yearInput" min="1900" max="2100">
        <button onclick="saveYear()">Next</button>
    `;
    document.getElementById("questionArea").innerHTML = q;
}

function saveYear() {
    year = parseInt(document.getElementById("yearInput").value);
    if (!year) { alert("Please enter a valid year"); return; }
    if (person === "individual") askIndividualQ1();
    else if (person === "huf") askHUFQ1();
    else if (person === "company") askCompanyQ1();
    else if (person === "firm") askFirmQ1();
}

function toggleHTML(id, label) {
    return `
        <label>${label}</label>
        <label class="switch">
            <input type="checkbox" id="${id}">
            <span class="slider"></span>
        </label>
    `;
}

function askIndividualQ1() {
    document.getElementById("questionArea").innerHTML = `
        <label>1. Number of days stayed in India during ${year}-${year+1}:</label>
        <input type="number" id="days">
        <button onclick="saveIndividualQ1()">Next</button>
    `;
}

function saveIndividualQ1() {
    const days = parseInt(document.getElementById("days").value);
    if (isNaN(days)) { alert("Enter valid number of days"); return; }
    answers.days = days;
    if (days < 182) askIndividualIncome();
    else showResult("Resident and ordinarily resident (ROR)");
}

function askIndividualIncome() {
    document.getElementById("questionArea").innerHTML = `
        <label>2. Total income (in lakhs) excluding foreign sources:</label>
        <input type="number" id="income">
        ${toggleHTML("deemed", "3. Are you an Indian citizen not liable to tax elsewhere?")}
        <button onclick="saveIndividualIncome()">Next</button>
    `;
}

function saveIndividualIncome() {
    const income = parseInt(document.getElementById("income").value);
    const deemed = document.getElementById("deemed").checked;
    if (isNaN(income)) { alert("Enter valid income"); return; }

    if (income >= 15 && deemed) {
        showResult("Deemed Resident (RNOR)");
    } else {
        askEmployment();
    }
}

function askEmployment() {
    document.getElementById("questionArea").innerHTML = `
        ${toggleHTML("crew", "4. Are you leaving India as a crew member or for employment?")}
        ${toggleHTML("visit", "5. Are you visiting India as an Indian citizen or PIO?")}
        <button onclick="saveEmployment()">Next</button>
    `;
}

function saveEmployment() {
    const crew = document.getElementById("crew").checked;
    const visit = document.getElementById("visit").checked;
    answers.crew = crew;
    answers.visit = visit;

    if ((crew || visit) && answers.income <= 15) {
        showResult("Non-Resident (NR)");
    } else if (visit && answers.income > 15) {
        askFourYearDays();
    } else {
        askFourYearDays();
    }
}

function askFourYearDays() {
    document.getElementById("questionArea").innerHTML = `
        <label>6. Number of days stayed in India during the 4 years preceding ${year}:</label>
        <input type="number" id="days4">
        <button onclick="saveFourYearDays()">Next</button>
    `;
}

function saveFourYearDays() {
    const days4 = parseInt(document.getElementById("days4").value);
    if (isNaN(days4)) { alert("Enter valid number"); return; }
    if (answers.days >= 60 && days4 >= 365) {
        showResult("Resident but not ordinarily resident (RNOR)");
    } else {
        showResult("Non-Resident (NR)");
    }
}

function askHUFQ1() {
    document.getElementById("questionArea").innerHTML = `
        ${toggleHTML("control", "Is the control and management of HUF situated in India?")}
        <button onclick="saveHUFQ1()">Next</button>
    `;
}

function saveHUFQ1() {
    const control = document.getElementById("control").checked;
    if (control) showResult("Resident HUF");
    else showResult("Non-Resident HUF");
}

function askFirmQ1() {
    document.getElementById("questionArea").innerHTML = `
        ${toggleHTML("control", "Is the control and management of the firm situated in India?")}
        <button onclick="saveFirmQ1()">Next</button>
    `;
}

function saveFirmQ1() {
    const control = document.getElementById("control").checked;
    if (control) showResult("Resident Firm");
    else showResult("Non-Resident Firm");
}

function askCompanyQ1() {
    document.getElementById("questionArea").innerHTML = `
        ${toggleHTML("poem", "Is the company Indian or POEM in India?")}
        <button onclick="saveCompanyQ1()">Next</button>
    `;
}

function saveCompanyQ1() {
    const poem = document.getElementById("poem").checked;
    if (poem) showResult("Resident Company");
    else showResult("Non-Resident Company");
}

function showResult(text) {
    document.getElementById("questionArea").innerHTML = "";
    document.getElementById("result").innerHTML = `âœ… ${text} for AY ${year + 1}-${(year - 2000) + 2}`;
}
</script>

</body>
</html>
